<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Calendar Creator</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="app-header">
            <h1>AI Calendar Creator</h1>
            <p class="lead">Create calendar events from images and text using AI interpretation</p>
        </header>

        <!-- Data Processing Modal -->
        <div id="dataModal" class="modal">
            <div class="modal-content">
                <span class="close-modal" id="closeDataModal">&times;</span>
                <h2>Terms of Service</h2>
                <div class="modal-body">
                    <p>We do not store your image or text! By using this service you grant permission to analyze and process your image and text in order to create calendar items and a calendar file. Your image and text are only used for the session and not stored or logged on the server. The text and image information are sent to OpenAI for intepretation. The image is loaded only into server memory and displayed back to you using browser in-memory and not stored server-side. The ICS calendar file is generated on-demand and is not stored on the server. If you have any questions or concerns, please contact <a href="mailto:hello@ericsoto.net">hello@ericsoto.net</a>.</p>
                </div>
            </div>
        </div>

        <section class="upload-section" id="uploadSection">
            <form id="uploadForm" class="text-center">
                <div class="mb-3">
                    <label for="image" class="form-label">Upload Image (Optional)</label>
                    <input type="file" class="form-control" id="image" name="image" accept="image/*">
                </div>
                <div class="mb-3">
                    <label for="text" class="form-label">Text Instructions</label>
                    <textarea class="form-control" id="text" name="text" rows="3" 
                              placeholder="Enter event details or instructions..."></textarea>
                </div>
                <div class="text-center">
                    <button type="submit" class="button" id="processButton">Process</button>
                    <p class="terms-text">Using this service constitutes acceptance of our <a href="#" id="termsLink">Terms of Service</a></p>
                </div>
                <div class="processing-indicator" id="processingIndicator">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Processing...</span>
                    </div>
                    <span class="ms-2">Processing your request...</span>
                </div>
            </form>
        </section>

        <section class="calendar-request hidden" id="calendarRequest">
            <h3>Calendar Request</h3>
            <div class="request-details">
                <div class="original-image-container hidden" id="originalImageContainer">
                    <div class="image-preview">
                        <img id="originalImage" src="" alt="Uploaded image" class="thumbnail">
                        <div class="image-modal" id="imageModal">
                            <span class="close-modal">&times;</span>
                            <img id="modalImage" src="" alt="Full size image">
                        </div>
                    </div>
                </div>
                <div class="original-text-container hidden" id="originalTextContainer">
                    <p id="originalText"></p>
                </div>
            </div>
        </section>

        <section class="chat-section hidden" id="chatSection">
            <p class="text-muted">Use this chat to make corrections to the events</p>
            <div class="chat-messages" id="chatMessages">
                <!-- Chat messages will appear here -->
            </div>
            <form id="chatForm">
                <div class="input-group mb-3">
                    <input type="text" class="form-control" id="chatInput" 
                           placeholder="Type your corrections here...">
                    <button class="button" type="submit">Send</button>
                </div>
            </form>
        </section>

        <section class="events-display hidden" id="eventsDisplay">
            <!-- Events will be displayed here -->
        </section>

        <div class="action-buttons" id="actionButtons">
            <button id="clearButton" class="button button-danger">Clear Session</button>
            <button id="downloadButton" class="button">Download ICS</button>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>